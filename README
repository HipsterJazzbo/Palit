Mostly recycled code for now. Working on my algorithm.